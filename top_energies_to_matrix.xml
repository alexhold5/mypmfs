<tool id = "pmf_matrix_generator" name = "PMF Energy Matrix Generator" version="0.01">
    <command>
        <![CDATA[top_energies_to_matrix.py --protein_file '$protein_file' --matrix '$matrix' ]]>
    </command>
    <inputs>
        <param name = "protein_file" type = "data" format = "csv" label = "Proteins" />
    </inputs>
    <outputs>
        <data name = "matrix" format = "txt" label="Output Energy Matrix"/>
        <data name = "tabular_data" format = "tsv" label = "Tabular Output" />
    </outputs>
    <tests>
        <test>
            <param name = "protein_file" value = "pdbdownload.txt" />
            <output name = "matrix" ftype = "txt">
                <assert_contents>    
                    <has_text text = "    C       M       F       I       L       V       W       Y       A       G       T       S       N       Q       D       E       H       R       K       P
                    -3.3165e+00 -1.99734e+00 -0.974244e+00 -1.69488e+00 -0.755943e+00 -1.39542e+00 -1.26844e+00 -1.32818e+00 -1.58534e+00 -4.54809e+00 -1.22404e+00 -1.32375e+00 -1.81877e+00 -1.36244e+00 -1.00063e+00 -0.914761e+00 -1.51447e+00 -0.951583e+00 -1.65741e+00 -1.20366e+00 
                    0e+00 -2.19182e+00 -3.68874e+00 -1.37006e+00 -2.13206e+00 -2.10633e+00 -1.39958e+00 -1.68055e+00 -2.05028e+00 -1.12135e+00 -1.3487e+00 -1.28357e+00 -1.68881e+00 -1.69688e+00 -1.26052e+00 -1.46493e+00 -1.35343e+00 -1.22284e+00 -1.61436e+00 -1.02366e+00 
                    0e+00 0e+00 -1.27945e+00 -1.40939e+00 -1.21442e+00 -1.02671e+00 -2.13568e+00 -2.25763e+00 -1.22714e+00 -1.62554e+00 -1.36512e+00 -0.942919e+00 -1.29201e+00 -1.16195e+00 -1.13071e+00 -0.948584e+00 -1.22796e+00 -1.20839e+00 -1.01115e+00 -1.23467e+00 
                    0e+00 0e+00 0e+00 -1.31922e+00 -0.692022e+00 -1.03706e+00 -1.28239e+00 -1.86108e+00 -1.0573e+00 -1.32678e+00 -1.22494e+00 -1.02494e+00 -0.973308e+00 -1.48055e+00 -1.48128e+00 -2.04425e+00 -1.55405e+00 -0.787419e+00 -1.04372e+00 -0.936827e+00 
                    0e+00 0e+00 0e+00 0e+00 -1.09144e+00 -1.32835e+00 -1.13389e+00 -1.16681e+00 -0.713597e+00 -1.08045e+00 -0.801671e+00 -0.791878e+00 -0.898875e+00 -1.15321e+00 -1.54018e+00 -0.736339e+00 -0.851848e+00 -2.02389e+00 -0.653932e+00 -0.852197e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 -2.15475e+00 -1.92045e+00 -1.32222e+00 -1.16925e+00 -3.53199e+00 -2.10155e+00 -0.833778e+00 -1.23509e+00 -1.76352e+00 -0.959811e+00 -1.28061e+00 -1.2552e+00 -0.772778e+00 -0.993201e+00 -0.84728e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -2.63413e+00 -1.88963e+00 -2.00435e+00 -1.15654e+00 -1.50819e+00 -1.39223e+00 -2.2321e+00 -1.46655e+00 -1.43565e+00 -1.03049e+00 -1.3004e+00 -0.947409e+00 -1.01604e+00 -1.29351e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.7212e+00 -1.15504e+00 -1.34255e+00 -1.36832e+00 -1.28882e+00 -1.36878e+00 -1.75146e+00 -1.1393e+00 -1.61385e+00 -1.29323e+00 -0.825972e+00 -1.05742e+00 -1.06345e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.15629e+00 -1.87204e+00 -0.98208e+00 -0.783831e+00 -0.855254e+00 -1.8388e+00 -1.10993e+00 -1.32788e+00 -1.26059e+00 -1.03487e+00 -0.60295e+00 -0.873723e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -3.59835e+00 -0.868312e+00 -2.2889e+00 -1.57672e+00 -2.13283e+00 -3.33981e+00 -1.67343e+00 -1.23423e+00 -2.59778e+00 -1.10428e+00 -1.66949e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.72593e+00 -1.10126e+00 -1.05491e+00 -1.26791e+00 -1.10387e+00 -0.835155e+00 -1.45547e+00 -1.46723e+00 -0.706183e+00 -1.16714e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.30611e+00 -1.46675e+00 -1.23496e+00 -1.14724e+00 -0.947868e+00 -0.821448e+00 -0.960193e+00 -1.05855e+00 -1.74439e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.15231e+00 -1.56435e+00 -1.39974e+00 -0.858807e+00 -1.62044e+00 -0.99304e+00 -0.858552e+00 -0.876844e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.48565e+00 -1.42299e+00 -0.99262e+00 -1.41526e+00 -1.18803e+00 -2.12183e+00 -0.831825e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.11257e+00 -1.01755e+00 -1.1194e+00 -0.986532e+00 -0.915872e+00 -1.52818e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.01903e+00 -1.58833e+00 -0.957595e+00 -2.2326e+00 -1.28052e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.49315e+00 -1.05496e+00 -1.12931e+00 -1.83941e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -0.839251e+00 -0.649113e+00 -1.8616e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -0.986669e+00 -0.788541e+00 
                    0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 -1.73988e+00" />
                </assert_contents>
            </output>
            <output name = "tabular_data" ftype = "tsv">
                <assert_contents>    
                    <has_text text = "CCAGCA	-4.54809
                    FCAMCA	-3.68874
                    GCAGCA	-3.59835
                    GCAVCA	-3.53199
                    DCAGCA	-3.33981
                    CCACCA	-3.3165
                    WCAWCA	-2.63413
                    GCARCA	-2.59778
                    GCASCA	-2.2889
                    FCAYCA	-2.25763
                    ECAKCA	-2.2326
                    NCAWCA	-2.2321
                    MCAMCA	-2.19182
                    VCAVCA	-2.15475
                    FCAWCA	-2.13568
                    GCAQCA	-2.13283
                    LCAMCA	-2.13206
                    KCAQCA	-2.12183
                    MCAVCA	-2.10633
                    TCAVCA	-2.10155
                    ACAMCA	-2.05028
                    ECAICA	-2.04425
                    LCARCA	-2.02389
                    ACAWCA	-2.00435
                    CCAMCA	-1.99734
                    VCAWCA	-1.92045
                    WCAYCA	-1.88963
                    ACAGCA	-1.87204
                    PCARCA	-1.8616
                    ICAYCA	-1.86108
                    HCAPCA	-1.83941
                    ACAQCA	-1.8388
                    CCANCA	-1.81877
                    QCAVCA	-1.76352
                    QCAYCA	-1.75146
                    PCASCA	-1.74439
                    PCAPCA	-1.73988
                    TCATCA	-1.72593
                    YCAYCA	-1.7212
                    MCAQCA	-1.69688
                    CCAICA	-1.69488
                    MCANCA	-1.68881
                    MCAYCA	-1.68055
                    ECAGCA	-1.67343
                    GCAPCA	-1.66949
                    CCAKCA	-1.65741
                    FCAGCA	-1.62554
                    HCANCA	-1.62044
                    KCAMCA	-1.61436
                    ECAYCA	-1.61385
                    ECAHCA	-1.58833
                    ACACCA	-1.58534
                    GCANCA	-1.57672
                    NCAQCA	-1.56435
                    HCAICA	-1.55405
                    DCALCA	-1.54018
                    DCAPCA	-1.52818
                    CCAHCA	-1.51447
                    TCAWCA	-1.50819
                    HCAHCA	-1.49315
                    QCAQCA	-1.48565
                    DCAICA	-1.48128
                    ICAQCA	-1.48055
                    RCATCA	-1.46723
                    NCASCA	-1.46675
                    QCAWCA	-1.46655
                    ECAMCA	-1.46493
                    HCATCA	-1.45547
                    DCAWCA	-1.43565
                    DCAQCA	-1.42299
                    HCAQCA	-1.41526
                    FCAICA	-1.40939
                    DCANCA	-1.39974
                    MCAWCA	-1.39958
                    CCAVCA	-1.39542
                    SCAWCA	-1.39223
                    ICAMCA	-1.37006
                    NCAYCA	-1.36878
                    TCAYCA	-1.36832
                    FCATCA	-1.36512
                    CCAQCA	-1.36244
                    HCAMCA	-1.35343
                    MCATCA	-1.3487
                    GCAYCA	-1.34255
                    LCAVCA	-1.32835
                    CCAYCA	-1.32818
                    ACAECA	-1.32788
                    GCAICA	-1.32678
                    CCASCA	-1.32375
                    VCAYCA	-1.32222
                    ICAICA	-1.31922
                    SCASCA	-1.30611
                    HCAWCA	-1.3004
                    PCAWCA	-1.29351
                    HCAYCA	-1.29323
                    FCANCA	-1.29201
                    SCAYCA	-1.28882
                    MCASCA	-1.28357
                    ICAWCA	-1.28239
                    ECAVCA	-1.28061
                    ECAPCA	-1.28052
                    FCAFCA	-1.27945
                    CCAWCA	-1.26844
                    QCATCA	-1.26791
                    ACAHCA	-1.26059
                    DCAMCA	-1.26052
                    HCAVCA	-1.2552
                    NCAVCA	-1.23509
                    QCASCA	-1.23496
                    FCAPCA	-1.23467
                    GCAHCA	-1.23423
                    FCAHCA	-1.22796
                    ACAFCA	-1.22714
                    ICATCA	-1.22494
                    CCATCA	-1.22404
                    MCARCA	-1.22284
                    FCALCA	-1.21442
                    FCARCA	-1.20839
                    CCAPCA	-1.20366
                    QCARCA	-1.18803
                    ACAVCA	-1.16925
                    PCATCA	-1.16714
                    LCAYCA	-1.16681
                    FCAQCA	-1.16195
                    GCAWCA	-1.15654
                    ACAACA	-1.15629
                    ACAYCA	-1.15504
                    LCAQCA	-1.15321
                    NCANCA	-1.15231
                    DCASCA	-1.14724
                    DCAYCA	-1.1393
                    LCAWCA	-1.13389
                    DCAFCA	-1.13071
                    HCAKCA	-1.12931
                    GCAMCA	-1.12135
                    DCAHCA	-1.1194
                    DCADCA	-1.11257
                    ACADCA	-1.10993
                    GCAKCA	-1.10428
                    DCATCA	-1.10387
                    SCATCA	-1.10126
                    LCALCA	-1.09144
                    GCALCA	-1.08045
                    PCAYCA	-1.06345
                    KCASCA	-1.05855
                    KCAYCA	-1.05742
                    ACAICA	-1.0573
                    HCARCA	-1.05496
                    NCATCA	-1.05491
                    ICAKCA	-1.04372
                    ICAVCA	-1.03706
                    ACARCA	-1.03487
                    ECAWCA	-1.03049
                    FCAVCA	-1.02671
                    ICASCA	-1.02494
                    MCAPCA	-1.02366
                    ECAECA	-1.01903
                    DCAECA	-1.01755
                    KCAWCA	-1.01604
                    FCAKCA	-1.01115
                    CCADCA	-1.00063
                    KCAVCA	-0.993201
                    NCARCA	-0.99304
                    ECAQCA	-0.99262
                    KCAKCA	-0.986669
                    DCARCA	-0.986532
                    ACATCA	-0.98208
                    CCAFCA	-0.974244
                    ICANCA	-0.973308
                    RCASCA	-0.960193
                    DCAVCA	-0.959811
                    ECARCA	-0.957595
                    CCARCA	-0.951583
                    ECAFCA	-0.948584
                    ECASCA	-0.947868
                    RCAWCA	-0.947409
                    FCASCA	-0.942919
                    ICAPCA	-0.936827
                    DCAKCA	-0.915872
                    CCAECA	-0.914761
                    LCANCA	-0.898875
                    NCAPCA	-0.876844
                    ACAPCA	-0.873723
                    GCATCA	-0.868312
                    ECANCA	-0.858807
                    KCANCA	-0.858552
                    ACANCA	-0.855254
                    LCAPCA	-0.852197
                    HCALCA	-0.851848
                    PCAVCA	-0.84728
                    RCARCA	-0.839251
                    ECATCA	-0.835155
                    SCAVCA	-0.833778
                    PCAQCA	-0.831825
                    RCAYCA	-0.825972
                    HCASCA	-0.821448
                    LCATCA	-0.801671
                    LCASCA	-0.791878
                    KCAPCA	-0.788541
                    ICARCA	-0.787419
                    ACASCA	-0.783831
                    RCAVCA	-0.772778
                    CCALCA	-0.755943
                    ECALCA	-0.736339
                    ACALCA	-0.713597
                    KCATCA	-0.706183
                    ICALCA	-0.692022
                    KCALCA	-0.653932
                    KCARCA	-0.649113
                    ACAKCA	-0.60295
                    " />
                </assert_contents>
            </output>
        </test>
    </tests>

    <help><![CDATA[Takes a csv file of pdb codes and outputs MJ style energy matrix using the mypmfs training tool]]></help>
    
    <citations>
        <citation type = "doi">https://github.com/bibip-impmc/mypmfs</citation>
    </citations>
</tool>